<?xml version="1.0" encoding="utf-8"?>
<!-- This file is processed by xharness, and contains logic shared by all our test suites -->
<Project>
	<!-- NativeLibName: the platform-specific subdirectory of tests/test-libraries/.libs where to get libraries with all the relevant architectures -->
	<Choose>

		<!-- Logic for iOS -->
		<When Condition="$(TargetFramework.EndsWith('-ios'))">
			<PropertyGroup> 
				<AssetTargetFallback>xamarinios10;$(AssetTargetFallback)</AssetTargetFallback>
				<NativeLibName>ios-fat</NativeLibName>
				<!-- We need this because we'd otherwise default to the latest OS version we support, and we'll want to execute on earlier versions -->
				<SupportedOSPlatformVersion>10.0</SupportedOSPlatformVersion>
				<CompilerResponseFile>$(MSBuildThisFileDirectory)\..\..\src\build\dotnet\ios-defines-dotnet.rsp</CompilerResponseFile>
			</PropertyGroup>
		</When>

		<!-- Logic for tvOS -->
		<When Condition="$(TargetFramework.EndsWith('-tvos'))">
			<PropertyGroup>
				<AssetTargetFallback>xamarintvos10;$(AssetTargetFallback)</AssetTargetFallback>
				<NativeLibName>tvos-fat</NativeLibName>
				<SupportedOSPlatformVersion>10.0</SupportedOSPlatformVersion>
				<CompilerResponseFile>$(MSBuildThisFileDirectory)\..\..\src\build\dotnet\tvos-defines-dotnet.rsp</CompilerResponseFile>
			</PropertyGroup>
		</When>

		<!-- Logic for macOS -->
		<When Condition="$(TargetFramework.EndsWith('-macos'))">
			<PropertyGroup> 
				<DefineConstants>$(DefineConstants);MONOMAC</DefineConstants>
				<NativeLibName>macos-fat</NativeLibName>
				<SupportedOSPlatformVersion>10.14</SupportedOSPlatformVersion>
				<CompilerResponseFile>$(MSBuildThisFileDirectory)\..\..\src\build\dotnet\macos-defines-dotnet.rsp</CompilerResponseFile>
			</PropertyGroup>
		</When>

		<!-- Logic for Mac Catalyst -->
		<When Condition="$(TargetFramework.EndsWith('-maccatalyst'))">
			<PropertyGroup> 
				<AssetTargetFallback>xamarinios10;$(AssetTargetFallback)</AssetTargetFallback>
				<NativeLibName>maccatalyst-fat</NativeLibName>
				<SupportedOSPlatformVersion>13.3</SupportedOSPlatformVersion>
				<CompilerResponseFile>$(MSBuildThisFileDirectory)\..\..\src\build\dotnet\maccatalyst-defines-dotnet.rsp</CompilerResponseFile>
			</PropertyGroup>
		</When>
	</Choose>

	<!-- Logic for all test suites -->
	<PropertyGroup>
		<!-- Disable the implicit FSharp.Core reference, because sometimes the implicit reference wants a version that isn't available anywhere -->
		<DisableImplicitFSharpCoreReference>true</DisableImplicitFSharpCoreReference>

		<!-- There's unsafe code in shared test code, which means pretty much all test suites need unsafe code -->
		<AllowUnsafeBlocks>true</AllowUnsafeBlocks>

		<!-- Always use the latest C# version everywhere -->
		<LangVersion>latest</LangVersion>

		<!-- XAMCORE_3_0 is always defined for .NET -->
		<DefineConstants>$(DefineConstants);XAMCORE_3_0</DefineConstants>
	</PropertyGroup>

	<ItemGroup>
		<PackageReference Include="NUnitLite" Version="3.12.0" />
		<ProjectReference Include="$(MSBuildThisFileDirectory)\..\..\external\Touch.Unit\Touch.Client\dotnet\$(_PlatformName)\Touch.Client-$(_PlatformName).dotnet.csproj" />
	</ItemGroup>

	<Import Project="$(MSBuildThisFileDirectory)/../nunit.framework.targets" />
</Project>
